{
    "models": {
        "vqvae": {
            "name": "SparseSDFVQVAE",
            "args": {
                "use_ema_update": true,
                "vq_decay": 0.99,
                "vq_epsilon": 1e-5,
                "use_kmeans_reinit": true,
                "kmeans_interval": 50,
                "reservoir_size": 16384,
                "resolution": 64,
                "model_channels": 512,
                "latent_channels": 16,
                "num_blocks": 8,
                "num_embeddings": 8192,
                "num_heads": null,
                "num_head_channels": 64,
                "mlp_ratio": 4.0,
                "attn_mode": "swin",
                "window_size": 8,
                "pe_mode": "ape",
                "use_fp16": false,
                "use_checkpoint": true,
                "qk_rms_norm": false,
                "representation_config": null
            }
        }
    },
    "dataset": {
        "name": "SparseSDF",
        "args": {
            "resolution": 512,
            "min_points": 100,
            "max_points": 1000000
        }
    },
    "trainer": {
        "name": "SparseSDF_VQVAETrainer",
        "args": {
            "training_stage": 2,
            "num_workers": 32,
            "pretrained_vae_path": "./outputs/ct_vqvae_stage1_2048/ckpts/vqvae_step0000600.pt",
            "max_steps": 100000,
            "max_epoch": 1,
            "batch_size_per_gpu": 16,
            "batch_split": 1,
            "disable_snapshot": true,
            "optimizer": {
                "name": "AdamW",
                "args": {
                    "lr": 1e-4,
                    "weight_decay": 0.01
                }
            },
            "lr_scheduler": {
                "name": "WarmupThenScheduler",
                "args": {
                    "warmup_steps": 100,
                    "main_scheduler_class": "CosineAnnealingLR",
                    "main_scheduler_kwargs": {
                        "T_max": 200000,
                        "eta_min": 5e-5
                    }
                }
            },
            "ema_rate": [0.9999],
            "fp16_mode": "inflat_all",
            "fp16_scale_growth": 0.001,
            "grad_clip": {
                "name": "AdaptiveGradClipper",
                "args": {
                    "max_norm": 1.0,
                    "clip_percentile": 90
                }
            },
            "lambda_vq": 1.0,
            "lambda_commitment": 0.25,
            "loss_type": "l1_l2",
            "i_print": 100,
            "i_log": 100,
            "i_sample": 100,
            "i_save": 100,
            "i_ddpcheck": 100
        }
    }
}

